//
// any_map.rs
// This file was generated by nitrogen. DO NOT MODIFY THIS FILE.
// https://github.com/mrousavy/nitro
// Copyright Â© Marc Rousavy @ Margelo
//
#![allow(
    non_camel_case_types,
    non_snake_case,
    dead_code,
    unused_imports,
    clippy::needless_return,
    clippy::redundant_closure,
    clippy::new_without_default,
    clippy::useless_conversion
)]

use std::ffi::c_void;

/// An opaque wrapper around a C++ `AnyMap` (untyped JS object).
///
/// This type represents a JavaScript object that doesn't have a typed schema.
/// It is passed through the FFI boundary as an opaque pointer.
/// Use typed `HashMap<K, V>` parameters instead when possible.
#[derive(Debug)]
pub struct AnyMap(*mut c_void);

// SAFETY: AnyMap wraps a shared_ptr<AnyMap> on the C++ side,
// which is reference-counted with atomic operations and is thread-safe.
unsafe impl Send for AnyMap {}
unsafe impl Sync for AnyMap {}

impl AnyMap {
    /// Get the underlying raw pointer.
    ///
    /// # Safety
    /// The caller must not use this pointer after the AnyMap is dropped.
    pub unsafe fn as_raw(&self) -> *mut c_void {
        self.0
    }

    /// Create an AnyMap from a raw opaque pointer.
    ///
    /// # Safety
    /// The pointer must be a valid C++ `shared_ptr<AnyMap>` passed from the FFI boundary.
    pub unsafe fn from_raw(ptr: *mut c_void) -> Self {
        AnyMap(ptr)
    }
}
